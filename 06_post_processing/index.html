
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Genomics Aotearoa & NeSI">
      
      
        <link rel="canonical" href="https://genomicsaotearoa.github.io/Gene_Regulatory_Networks_Simulation_Workshop/06_post_processing/">
      
      <link rel="icon" href="../images/nesi_ga.png">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.3.9">
    
    
      
        <title>6. Post-processing - Scaling Gene Regulatory Networks Simulations</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.1d29e8d0.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.cbb835fc.min.css">
        
      
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Mukta:300,300i,400,400i,700,700i%7CFira+Code:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Mukta";--md-code-font:"Fira Code"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="deep-purple" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#6-post-processing" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Scaling Gene Regulatory Networks Simulations" class="md-header__button md-logo" aria-label="Scaling Gene Regulatory Networks Simulations" data-md-component="logo">
      
  <img src="../images/nesi_ga.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Scaling Gene Regulatory Networks Simulations
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              6. Post-processing
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="" data-md-color-primary="deep-purple" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_3" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9h-1.9M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69m-9.15 3.96h2.3L12 9l-1.15 3.65Z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="deep-purple" data-md-color-accent=""  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_3">
          
            <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/GenomicsAotearoa/Gene_Regulatory_Networks_Simulation_Workshop.git" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GenomicsAotearoa/Gene_Regulatory_Networks_Simulation_Workshop
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Scaling Gene Regulatory Networks Simulations" class="md-nav__button md-logo" aria-label="Scaling Gene Regulatory Networks Simulations" data-md-component="logo">
      
  <img src="../images/nesi_ga.png" alt="logo">

    </a>
    Scaling Gene Regulatory Networks Simulations
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/GenomicsAotearoa/Gene_Regulatory_Networks_Simulation_Workshop.git" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GenomicsAotearoa/Gene_Regulatory_Networks_Simulation_Workshop
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../01_introduction/" class="md-nav__link">
        1. Introduction
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../02_getting_started_sismonr/" class="md-nav__link">
        2. Getting started with sismonr
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../03_scaling_up/" class="md-nav__link">
        3. Scaling up your work
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../04_working_with_job_scheduler/" class="md-nav__link">
        4. Working with job scheduler
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../05_parallel_job_arrays/" class="md-nav__link">
        5. Parallel Job Arrays
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          6. Post-processing
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        6. Post-processing
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#checking-that-the-job-array-worked" class="md-nav__link">
    Checking that the job array worked
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#interpreting-the-sismonr-output" class="md-nav__link">
    Interpreting the sismonr output
  </a>
  
    <nav class="md-nav" aria-label="Interpreting the sismonr output">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#copying-the-simulation-outputs-to-relevant-directory" class="md-nav__link">
    Copying the simulation outputs to relevant directory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#looking-at-one-simulation-output" class="md-nav__link">
    Looking at one simulation output
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#importing-all-simulation-results-in-r" class="md-nav__link">
    Importing all simulation results in R
  </a>
  
    <nav class="md-nav" aria-label="Importing all simulation results in R">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#listing-all-the-simulation-files" class="md-nav__link">
    Listing all the simulation files
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-a-loop-to-import-all-simulations" class="md-nav__link">
    Creating a loop to import all simulations
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#modifying-the-simulation-outputs" class="md-nav__link">
    Modifying the simulation outputs
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#visualising-the-simulations" class="md-nav__link">
    Visualising the simulations
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#comparing-dfr-expression-between-the-two-plants" class="md-nav__link">
    Comparing DFR expression between the two plants
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    Conclusion
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../07_supplementary/" class="md-nav__link">
        Supplementary.1
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../08_supplementary_2/" class="md-nav__link">
        Supplementary.2
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#checking-that-the-job-array-worked" class="md-nav__link">
    Checking that the job array worked
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#interpreting-the-sismonr-output" class="md-nav__link">
    Interpreting the sismonr output
  </a>
  
    <nav class="md-nav" aria-label="Interpreting the sismonr output">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#copying-the-simulation-outputs-to-relevant-directory" class="md-nav__link">
    Copying the simulation outputs to relevant directory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#looking-at-one-simulation-output" class="md-nav__link">
    Looking at one simulation output
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#importing-all-simulation-results-in-r" class="md-nav__link">
    Importing all simulation results in R
  </a>
  
    <nav class="md-nav" aria-label="Importing all simulation results in R">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#listing-all-the-simulation-files" class="md-nav__link">
    Listing all the simulation files
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-a-loop-to-import-all-simulations" class="md-nav__link">
    Creating a loop to import all simulations
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#modifying-the-simulation-outputs" class="md-nav__link">
    Modifying the simulation outputs
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#visualising-the-simulations" class="md-nav__link">
    Visualising the simulations
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#comparing-dfr-expression-between-the-two-plants" class="md-nav__link">
    Comparing DFR expression between the two plants
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    Conclusion
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
  <a href="https://github.com/GenomicsAotearoa/Gene_Regulatory_Networks_Simulation_Workshop.git/edit/master/docs/06_post_processing.md" title="Edit this page" class="md-content__button md-icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>



<h1 id="6-post-processing">6. Post-processing<a class="headerlink" href="#6-post-processing" title="Permanent link">&para;</a></h1>
<h2 id="checking-that-the-job-array-worked">Checking that the job array worked<a class="headerlink" href="#checking-that-the-job-array-worked" title="Permanent link">&para;</a></h2>
<p>In the previous section, you have seen how to run a slurm array job. Now it is time to check whether the arrays completed without failing! And if some of the arrays did fail, we would like to identify them to re-run them.</p>
<p>As we have seen in the previous sections, the <code>sacct</code> command is useful to assess the status of submitted jobs. However, especially if you have many arrays, it can get difficult to find what you are looking for in the output. Fortunately, there is a (rather lengthy) command which allows you to obtain the ID of the arrays that failed in a format compatible with slurm. The advantage is that you can directly copy the output of this command and paste it in your slurm script for the <code>array</code> option, in order to re-run only those arrays that failed. Type the following command in the terminal:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>$ sacct -j <span class="nv">$JOB_ID</span> -X -n -s TO,F,OOM -o jobid <span class="p">|</span> cut -d <span class="s2">&quot;_&quot;</span> -f2 <span class="p">|</span> tr -s <span class="s1">&#39; \n&#39;</span> <span class="s1">&#39;,&#39;</span>
</code></pre></div>
<p>In the command, you'll need to replace <code>$JOB_ID</code> by your actual slurm job ID.</p>
<p>Your turn! Did any of your arrays failed? If so, what would you change before re-running them?</p>
<div class="admonition info">
<p class="admonition-title"><strong>Index</strong></p>
<ul>
<li><code>TO</code> = Timed Out</li>
<li><code>F</code> = Failed</li>
<li><code>OOM</code> = Out Of Memory</li>
</ul>
</div>
<h2 id="interpreting-the-sismonr-output">Interpreting the sismonr output<a class="headerlink" href="#interpreting-the-sismonr-output" title="Permanent link">&para;</a></h2>
<p>Now, it is time to analyse the simulations that we generated. </p>
<h3 id="copying-the-simulation-outputs-to-relevant-directory">Copying the simulation outputs to relevant directory<a class="headerlink" href="#copying-the-simulation-outputs-to-relevant-directory" title="Permanent link">&para;</a></h3>
<p>In the simulation script, we made sure to save each simulation into a <code>.RData</code> file. First, make sure that you are in the appropriate directory by typing in the terminal:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>$ <span class="nb">pwd</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>/nesi/project/nesi02659/sismonr_workshop/workingdir/me123/Exercise_5.5
</code></pre></div>
<p><strong>IMPORTANT:</strong> there should be only once person per group that submitted the job, and so the other members of the group should first copy the results of the simulation via the command:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>$ cp /nesi/project/nesi02659/sismonr_workshop/workingdir/member456/Exercise_5.5/simulation_* /nesi/project/nesi02659/sismonr_workshop/workingdir/me123/Exercise_5.5/
</code></pre></div>
<p>of course replacing <code>member456</code> by the username of the person that has the simulations.</p>
<h3 id="looking-at-one-simulation-output">Looking at one simulation output<a class="headerlink" href="#looking-at-one-simulation-output" title="Permanent link">&para;</a></h3>
<p>Start a new sismonr Jupyter Notebook in the folder containing the simulations output. In the first cell, add and execute:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="nf">library</span><span class="p">(</span><span class="n">sismonr</span><span class="p">)</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="nf">library</span><span class="p">(</span><span class="n">tibble</span><span class="p">)</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="nf">library</span><span class="p">(</span><span class="n">dplyr</span><span class="p">)</span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="nf">library</span><span class="p">(</span><span class="n">purrr</span><span class="p">)</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="nf">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span>
</code></pre></div>
<p>A single <code>.RData</code> file can be then loaded into R with:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="nf">load</span><span class="p">(</span><span class="s">&quot;simulation_1_group_1.RData&quot;</span><span class="p">)</span>
</code></pre></div>
<p>The output of sismonr is a list composed of 3 elements:</p>
<ul>
<li>
<p><code>Simulation</code>: a data-frame with the simulation results. Columns <code>time</code>, <code>Ind</code> and <code>trial</code> indicate the time (in seconds) in the simulation, <em>in silico individual</em> and trial (i.e. repeat of the simulation), respectively. The remaining columns each correspond to one molecular species present in the simulated system, and the values correspond to their abundance for the given time, individual and trial;</p>
</li>
<li>
<p><code>runningtime</code>: a vector giving, for each <em>in silico</em> individual, the running time (in seconds) of the simulations (across all trials);</p>
</li>
<li>
<p><code>stochmodel</code>: a Julia proxy object, giving the stochastic model used for the simulation. You probably won't ever need to work with this object.</p>
</li>
</ul>
<p>We are only interested in the <code>Simulation</code> data-frame.</p>
<p>If you try to load one of your simulation files and have a look at this data-frame, it should look something like this (note that I'm using <code>as_tibble()</code> to get a nicer visualisation of the data-frame):</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="nf">as_tibble</span><span class="p">(</span><span class="n">sim</span><span class="o">$</span><span class="n">Simulation</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="c1"># A tibble: 4,804 × 203</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>    <span class="n">time</span> <span class="n">trial</span> <span class="n">R1GCN1</span> <span class="n">P1GCN1</span> <span class="n">R4GCN2</span> <span class="n">P4GCN2</span> <span class="n">R5GCN2</span> <span class="n">P5GCN2</span> <span class="n">R6GCN1</span> <span class="n">P6GCN1</span> <span class="n">R2GCN2</span> <span class="n">P2GCN2</span> <span class="n">R7GCN2</span> <span class="n">P7GCN2</span> <span class="n">R5GCN1</span> <span class="n">P5GCN1</span> <span class="n">R3GCN1</span> <span class="n">P3GCN1</span> <span class="n">R4GCN1</span> <span class="n">P4GCN1</span> <span class="n">R3GCN2</span> <span class="n">P3GCN2</span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>   <span class="o">&lt;</span><span class="n">dbl</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">dbl</span><span class="o">&gt;</span>  <span class="o">&lt;</span><span class="n">dbl</span><span class="o">&gt;</span>  <span class="o">&lt;</span><span class="n">dbl</span><span class="o">&gt;</span>  <span class="o">&lt;</span><span class="n">dbl</span><span class="o">&gt;</span>  <span class="o">&lt;</span><span class="n">dbl</span><span class="o">&gt;</span>  <span class="o">&lt;</span><span class="n">dbl</span><span class="o">&gt;</span>  <span class="o">&lt;</span><span class="n">dbl</span><span class="o">&gt;</span>  <span class="o">&lt;</span><span class="n">dbl</span><span class="o">&gt;</span>  <span class="o">&lt;</span><span class="n">dbl</span><span class="o">&gt;</span>  <span class="o">&lt;</span><span class="n">dbl</span><span class="o">&gt;</span>  <span class="o">&lt;</span><span class="n">dbl</span><span class="o">&gt;</span>  <span class="o">&lt;</span><span class="n">dbl</span><span class="o">&gt;</span>  <span class="o">&lt;</span><span class="n">dbl</span><span class="o">&gt;</span>  <span class="o">&lt;</span><span class="n">dbl</span><span class="o">&gt;</span>  <span class="o">&lt;</span><span class="n">dbl</span><span class="o">&gt;</span>  <span class="o">&lt;</span><span class="n">dbl</span><span class="o">&gt;</span>  <span class="o">&lt;</span><span class="n">dbl</span><span class="o">&gt;</span>  <span class="o">&lt;</span><span class="n">dbl</span><span class="o">&gt;</span>  <span class="o">&lt;</span><span class="n">dbl</span><span class="o">&gt;</span>  <span class="o">&lt;</span><span class="n">dbl</span><span class="o">&gt;</span>  <span class="o">&lt;</span><span class="n">dbl</span><span class="o">&gt;</span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a> <span class="m">1</span>     <span class="m">0</span>     <span class="m">1</span>      <span class="m">0</span>      <span class="m">0</span>      <span class="m">0</span>      <span class="m">0</span>      <span class="m">0</span>      <span class="m">0</span>      <span class="m">0</span>      <span class="m">0</span>     <span class="m">10</span>    <span class="m">100</span>      <span class="m">0</span>      <span class="m">0</span>      <span class="m">0</span>      <span class="m">0</span>     <span class="m">50</span>    <span class="m">500</span>      <span class="m">0</span>      <span class="m">0</span>     <span class="m">50</span>    <span class="m">500</span>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a> <span class="m">2</span>     <span class="m">1</span>     <span class="m">1</span>      <span class="m">4</span>      <span class="m">0</span>      <span class="m">0</span>      <span class="m">0</span>      <span class="m">0</span>      <span class="m">0</span>      <span class="m">0</span>      <span class="m">0</span>     <span class="m">10</span>      <span class="m">0</span>      <span class="m">1</span>      <span class="m">0</span>      <span class="m">0</span>      <span class="m">0</span>     <span class="m">50</span>    <span class="m">445</span>      <span class="m">0</span>      <span class="m">0</span>     <span class="m">51</span>    <span class="m">455</span>
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a> <span class="m">3</span>     <span class="m">2</span>     <span class="m">1</span>      <span class="m">7</span>      <span class="m">0</span>      <span class="m">0</span>      <span class="m">0</span>      <span class="m">0</span>      <span class="m">0</span>      <span class="m">0</span>      <span class="m">0</span>      <span class="m">9</span>      <span class="m">0</span>      <span class="m">2</span>      <span class="m">0</span>      <span class="m">0</span>      <span class="m">0</span>     <span class="m">51</span>    <span class="m">444</span>      <span class="m">0</span>      <span class="m">0</span>     <span class="m">52</span>    <span class="m">457</span>
<a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a> <span class="m">4</span>     <span class="m">3</span>     <span class="m">1</span>     <span class="m">13</span>      <span class="m">0</span>      <span class="m">0</span>      <span class="m">0</span>      <span class="m">0</span>      <span class="m">0</span>      <span class="m">0</span>      <span class="m">0</span>     <span class="m">10</span>      <span class="m">0</span>      <span class="m">4</span>      <span class="m">0</span>      <span class="m">0</span>      <span class="m">0</span>     <span class="m">51</span>    <span class="m">448</span>      <span class="m">0</span>      <span class="m">0</span>     <span class="m">52</span>    <span class="m">453</span>
<a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a> <span class="m">5</span>     <span class="m">4</span>     <span class="m">1</span>     <span class="m">21</span>      <span class="m">1</span>      <span class="m">0</span>      <span class="m">0</span>      <span class="m">0</span>      <span class="m">0</span>      <span class="m">0</span>      <span class="m">0</span>     <span class="m">10</span>      <span class="m">0</span>      <span class="m">6</span>      <span class="m">0</span>      <span class="m">0</span>      <span class="m">0</span>     <span class="m">51</span>    <span class="m">447</span>      <span class="m">0</span>      <span class="m">0</span>     <span class="m">53</span>    <span class="m">452</span>
<a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a> <span class="m">6</span>     <span class="m">5</span>     <span class="m">1</span>     <span class="m">22</span>      <span class="m">2</span>      <span class="m">0</span>      <span class="m">0</span>      <span class="m">0</span>      <span class="m">0</span>      <span class="m">1</span>      <span class="m">0</span>     <span class="m">10</span>      <span class="m">0</span>      <span class="m">7</span>      <span class="m">0</span>      <span class="m">0</span>      <span class="m">0</span>     <span class="m">50</span>    <span class="m">448</span>      <span class="m">0</span>      <span class="m">0</span>     <span class="m">52</span>    <span class="m">453</span>
<a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a> <span class="m">7</span>     <span class="m">6</span>     <span class="m">1</span>     <span class="m">24</span>      <span class="m">0</span>      <span class="m">0</span>      <span class="m">0</span>      <span class="m">0</span>      <span class="m">0</span>      <span class="m">1</span>      <span class="m">0</span>     <span class="m">10</span>      <span class="m">0</span>      <span class="m">7</span>      <span class="m">0</span>      <span class="m">0</span>      <span class="m">0</span>     <span class="m">50</span>    <span class="m">446</span>      <span class="m">0</span>      <span class="m">0</span>     <span class="m">52</span>    <span class="m">454</span>
<a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a> <span class="m">8</span>     <span class="m">7</span>     <span class="m">1</span>     <span class="m">25</span>      <span class="m">0</span>      <span class="m">0</span>      <span class="m">0</span>      <span class="m">0</span>      <span class="m">0</span>      <span class="m">2</span>      <span class="m">0</span>     <span class="m">10</span>      <span class="m">1</span>      <span class="m">7</span>      <span class="m">0</span>      <span class="m">0</span>      <span class="m">0</span>     <span class="m">50</span>    <span class="m">447</span>      <span class="m">0</span>      <span class="m">0</span>     <span class="m">52</span>    <span class="m">454</span>
<a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a> <span class="m">9</span>     <span class="m">8</span>     <span class="m">1</span>     <span class="m">28</span>      <span class="m">1</span>      <span class="m">0</span>      <span class="m">0</span>      <span class="m">0</span>      <span class="m">0</span>      <span class="m">2</span>      <span class="m">0</span>     <span class="m">10</span>      <span class="m">0</span>      <span class="m">7</span>      <span class="m">0</span>      <span class="m">0</span>      <span class="m">0</span>     <span class="m">51</span>    <span class="m">446</span>      <span class="m">0</span>      <span class="m">0</span>     <span class="m">51</span>    <span class="m">456</span>
<a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a><span class="m">10</span>     <span class="m">9</span>     <span class="m">1</span>     <span class="m">34</span>      <span class="m">0</span>      <span class="m">0</span>      <span class="m">0</span>      <span class="m">0</span>      <span class="m">0</span>      <span class="m">2</span>      <span class="m">0</span>     <span class="m">10</span>      <span class="m">0</span>      <span class="m">7</span>      <span class="m">0</span>      <span class="m">0</span>      <span class="m">0</span>     <span class="m">50</span>    <span class="m">445</span>      <span class="m">0</span>      <span class="m">0</span>     <span class="m">51</span>    <span class="m">457</span>
<a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a><span class="c1"># … with 4,794 more rows, and 181 more variables: R2GCN1 &lt;dbl&gt;, P2GCN1 &lt;dbl&gt;, R1GCN2 &lt;dbl&gt;, P1GCN2 &lt;dbl&gt;, R7GCN1 &lt;dbl&gt;, P7GCN1 &lt;dbl&gt;, R6GCN2 &lt;dbl&gt;,</span>
<a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a><span class="c1">#   P6GCN2 &lt;dbl&gt;, CTC1_P2GCN1_P2GCN1 &lt;dbl&gt;, CTC1_P2GCN1_P2GCN2 &lt;dbl&gt;, CTC1_P2GCN2_P2GCN1 &lt;dbl&gt;, CTC1_P2GCN2_P2GCN2 &lt;dbl&gt;, CTC5_P4GCN1_P4GCN1 &lt;dbl&gt;,</span>
<a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a><span class="c1">#   CTC5_P4GCN1_P4GCN2 &lt;dbl&gt;, CTC5_P4GCN2_P4GCN1 &lt;dbl&gt;, CTC5_P4GCN2_P4GCN2 &lt;dbl&gt;, CTC2_P1GCN1_P1GCN1 &lt;dbl&gt;, CTC2_P1GCN1_P1GCN2 &lt;dbl&gt;,</span>
<a id="__codelineno-6-17" name="__codelineno-6-17" href="#__codelineno-6-17"></a><span class="c1">#   CTC2_P1GCN2_P1GCN1 &lt;dbl&gt;, CTC2_P1GCN2_P1GCN2 &lt;dbl&gt;, CTC6_P3GCN1_CTC5_P4GCN1_P4GCN1 &lt;dbl&gt;, CTC6_P3GCN1_CTC5_P4GCN1_P4GCN2 &lt;dbl&gt;,</span>
<a id="__codelineno-6-18" name="__codelineno-6-18" href="#__codelineno-6-18"></a><span class="c1">#   CTC6_P3GCN1_CTC5_P4GCN2_P4GCN1 &lt;dbl&gt;, CTC6_P3GCN1_CTC5_P4GCN2_P4GCN2 &lt;dbl&gt;, CTC6_P3GCN2_CTC5_P4GCN1_P4GCN1 &lt;dbl&gt;,</span>
<a id="__codelineno-6-19" name="__codelineno-6-19" href="#__codelineno-6-19"></a><span class="c1">#   CTC6_P3GCN2_CTC5_P4GCN1_P4GCN2 &lt;dbl&gt;, CTC6_P3GCN2_CTC5_P4GCN2_P4GCN1 &lt;dbl&gt;, CTC6_P3GCN2_CTC5_P4GCN2_P4GCN2 &lt;dbl&gt;,</span>
<a id="__codelineno-6-20" name="__codelineno-6-20" href="#__codelineno-6-20"></a><span class="c1">#   CTC3_P3GCN1_CTC1_P2GCN1_P2GCN1 &lt;dbl&gt;, CTC3_P3GCN1_CTC1_P2GCN1_P2GCN2 &lt;dbl&gt;, CTC3_P3GCN1_CTC1_P2GCN2_P2GCN1 &lt;dbl&gt;, …</span>
</code></pre></div>
<p>Notice that each species has a suffix on the form <code>GCN1</code> or <code>GCN2</code>. This is because sismonr tracks the allele of origin of each molecule. As we are simulating a diploid system, each gene is present in 2 copies (two alleles), and so the RNAs and proteins of a given gene can originate from either of these two alleles. This can be really handy when looking at the impact of mutations of different alleles. In this case however, we don't care about the allele of origin of the different species. Instead, we would rather have the abundance of all RNAs or proteins for a given gene into one column. To obtain that, we can use the sismonr function <code>mergeAlleleAbundance</code>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="n">merged_simulation</span> <span class="o">&lt;-</span> <span class="nf">mergeAlleleAbundance</span><span class="p">(</span><span class="n">sim</span><span class="o">$</span><span class="n">Simulation</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="nf">as_tibble</span><span class="p">(</span><span class="n">merged_simulation</span><span class="p">)</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="c1"># A tibble: 4,804 × 27</span>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>    <span class="n">time</span> <span class="n">trial</span> <span class="n">Ind</span>      <span class="n">R1</span>    <span class="n">P1</span>    <span class="n">R4</span>    <span class="n">P4</span>    <span class="n">R5</span>    <span class="n">P5</span>    <span class="n">R6</span>    <span class="n">P6</span>    <span class="n">R2</span>    <span class="n">P2</span>    <span class="n">R7</span>    <span class="n">P7</span>    <span class="n">R3</span>    <span class="n">P3</span>  <span class="n">CTC1</span>  <span class="n">CTC5</span>  <span class="n">CTC2</span>  <span class="n">CTC6</span>  <span class="n">CTC3</span>  <span class="n">CTC7</span>  <span class="n">CTC8</span>  <span class="n">CTC4</span>
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a>   <span class="o">&lt;</span><span class="n">dbl</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">dbl</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">chr</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">dbl</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">dbl</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">dbl</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">dbl</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">dbl</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">dbl</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">dbl</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">dbl</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">dbl</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">dbl</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">dbl</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">dbl</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">dbl</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">dbl</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">dbl</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">dbl</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">dbl</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">dbl</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">dbl</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">dbl</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">dbl</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">dbl</span><span class="o">&gt;</span>
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a> <span class="m">1</span>     <span class="m">0</span>     <span class="m">1</span> <span class="n">Ind1</span>      <span class="m">0</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">0</span>    <span class="m">20</span>   <span class="m">200</span>     <span class="m">0</span>     <span class="m">0</span>   <span class="m">100</span>  <span class="m">1000</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">0</span>
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a> <span class="m">2</span>     <span class="m">1</span>     <span class="m">1</span> <span class="n">Ind1</span>     <span class="m">14</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">0</span>    <span class="m">20</span>     <span class="m">1</span>     <span class="m">1</span>     <span class="m">0</span>   <span class="m">101</span>   <span class="m">900</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">0</span>   <span class="m">100</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">0</span>
<a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a> <span class="m">3</span>     <span class="m">2</span>     <span class="m">1</span> <span class="n">Ind1</span>     <span class="m">16</span>     <span class="m">1</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">0</span>    <span class="m">19</span>     <span class="m">1</span>     <span class="m">2</span>     <span class="m">0</span>   <span class="m">103</span>   <span class="m">901</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">0</span>   <span class="m">100</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">0</span>
<a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a> <span class="m">4</span>     <span class="m">3</span>     <span class="m">1</span> <span class="n">Ind1</span>     <span class="m">25</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">0</span>    <span class="m">20</span>     <span class="m">2</span>     <span class="m">4</span>     <span class="m">0</span>   <span class="m">103</span>   <span class="m">901</span>     <span class="m">1</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">0</span>    <span class="m">98</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">1</span>
<a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a> <span class="m">5</span>     <span class="m">4</span>     <span class="m">1</span> <span class="n">Ind1</span>     <span class="m">32</span>     <span class="m">1</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">0</span>    <span class="m">20</span>     <span class="m">2</span>     <span class="m">6</span>     <span class="m">0</span>   <span class="m">104</span>   <span class="m">899</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">0</span>    <span class="m">96</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">4</span>
<a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a> <span class="m">6</span>     <span class="m">5</span>     <span class="m">1</span> <span class="n">Ind1</span>     <span class="m">39</span>     <span class="m">2</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">1</span>     <span class="m">0</span>    <span class="m">18</span>     <span class="m">0</span>     <span class="m">8</span>     <span class="m">0</span>   <span class="m">102</span>   <span class="m">901</span>     <span class="m">1</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">0</span>    <span class="m">96</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">4</span>
<a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a> <span class="m">7</span>     <span class="m">6</span>     <span class="m">1</span> <span class="n">Ind1</span>     <span class="m">40</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">1</span>     <span class="m">0</span>    <span class="m">18</span>     <span class="m">0</span>     <span class="m">8</span>     <span class="m">0</span>   <span class="m">102</span>   <span class="m">900</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">0</span>    <span class="m">95</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">4</span>
<a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a> <span class="m">8</span>     <span class="m">7</span>     <span class="m">1</span> <span class="n">Ind1</span>     <span class="m">46</span>     <span class="m">1</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">2</span>     <span class="m">0</span>    <span class="m">18</span>     <span class="m">1</span>     <span class="m">9</span>     <span class="m">0</span>   <span class="m">102</span>   <span class="m">901</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">0</span>    <span class="m">94</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">6</span>
<a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a> <span class="m">9</span>     <span class="m">8</span>     <span class="m">1</span> <span class="n">Ind1</span>     <span class="m">54</span>     <span class="m">2</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">2</span>     <span class="m">0</span>    <span class="m">18</span>     <span class="m">1</span>    <span class="m">10</span>     <span class="m">0</span>   <span class="m">102</span>   <span class="m">902</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">0</span>    <span class="m">93</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">7</span>
<a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a><span class="m">10</span>     <span class="m">9</span>     <span class="m">1</span> <span class="n">Ind1</span>     <span class="m">65</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">3</span>     <span class="m">0</span>    <span class="m">18</span>     <span class="m">1</span>    <span class="m">10</span>     <span class="m">0</span>   <span class="m">101</span>   <span class="m">902</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">0</span>     <span class="m">0</span>    <span class="m">90</span>     <span class="m">0</span>     <span class="m">0</span>    <span class="m">10</span>
<a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a><span class="c1"># … with 4,794 more rows, and 2 more variables: CTC9 &lt;dbl&gt;, CTC10 &lt;dbl&gt;</span>
</code></pre></div>
<p>This time, we have one column for the RNA abundance of each gene, and idem for the proteins and regulatory complexes. This will be much more practical to create some plots.</p>
<p>One more thing to note: in each simulation output, the <code>trial</code> column will be filled with <code>1</code> and <code>2</code>. This is something to keep in mind when we'll load all the simulation outputs, as ideally we would like to have values from <code>1</code> to <code>500</code>.</p>
<h2 id="importing-all-simulation-results-in-r">Importing all simulation results in R<a class="headerlink" href="#importing-all-simulation-results-in-r" title="Permanent link">&para;</a></h2>
<p>The challenge here is we don't have only 1 <code>.RData</code> file; in fact, we've just created 250 of them per group! We will need to use a loop of some sort to import all simulations in R.</p>
<h3 id="listing-all-the-simulation-files">Listing all the simulation files<a class="headerlink" href="#listing-all-the-simulation-files" title="Permanent link">&para;</a></h3>
<p>The first thing we need is a list of all simulation files. There is a function in R just for that: <code>list.files</code>. It will list all files present in the given directory that match a specific pattern.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="c1">## Don&#39;t forget to update the pattern to reflect how you named your simulation outputs</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="c1">## For example, replace &#39;group_1&#39; by your group ID</span>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="n">sim_files</span> <span class="o">&lt;-</span> <span class="nf">list.files</span><span class="p">(</span><span class="n">path</span> <span class="o">=</span> <span class="s">&quot;./&quot;</span><span class="p">,</span> <span class="n">pattern</span> <span class="o">=</span> <span class="s">&quot;_group_1.RData&quot;</span><span class="p">)</span>
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="nf">head</span><span class="p">(</span><span class="n">sim_files</span><span class="p">)</span>
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a>
<a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="s">&quot;simulation_1_group_1.RData&quot;</span>   <span class="s">&quot;simulation_10_group_1.RData&quot;</span>  <span class="s">&quot;simulation_100_group_1.RData&quot;</span> <span class="s">&quot;simulation_101_group_1.RData&quot;</span>
<a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="p">[</span><span class="m">5</span><span class="p">]</span> <span class="s">&quot;simulation_102_group_1.RData&quot;</span> <span class="s">&quot;simulation_103_group_1.RData&quot;</span>
</code></pre></div>
<p>You can check that there are 250 files:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="n">n_sim</span> <span class="o">&lt;-</span> <span class="nf">length</span><span class="p">(</span><span class="n">sim_files</span><span class="p">)</span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="n">n_sim</span>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="m">250</span>
</code></pre></div>
<h3 id="creating-a-loop-to-import-all-simulations">Creating a loop to import all simulations<a class="headerlink" href="#creating-a-loop-to-import-all-simulations" title="Permanent link">&para;</a></h3>
<p>To import each of these simulations, we could use a basic <code>for</code> loop, which would look something like this:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="c1"># DO NOT RUN</span>
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="n">sim_df</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">()</span>
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="nf">for</span><span class="p">(</span><span class="n">file</span> <span class="n">in</span> <span class="n">sim_files</span><span class="p">){</span>
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a>  <span class="nf">load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a>  <span class="n">sim_df</span> <span class="o">&lt;-</span> <span class="nf">bind_rows</span><span class="p">(</span><span class="n">sim_df</span><span class="p">,</span> <span class="n">sim</span><span class="o">$</span><span class="n">Simulation</span><span class="p">)</span>
<a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="p">}</span>
</code></pre></div>
<p>Which is really not ideal from a memory and computational time perspective. However, there is a nice alternative, which relies on the package <code>purrr</code>. Specifically, purrr provides a function, <code>reduce</code>, which applies a given function to a list of data-frames. In our case, if we can obtain a list of all simulations, we can apply the <code>bind_rows</code> function from <code>dplyr</code> to it, through <code>reduce</code>, to combine the individual simulations into one data-frame. And an added bonus: it works with the tidyverse pipe! </p>
<p>To get the list of data-frame, the R function <code>lapply()</code> does just what we want: it acts as a for loop, except that it returns the output of the different iterations as a list. So we could use something like:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="c1"># AGAIN DO NOT RUN</span>
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="n">sim_df</span> <span class="o">&lt;-</span> <span class="nf">lapply</span><span class="p">(</span><span class="n">sim_files</span><span class="p">,</span> <span class="nf">function</span><span class="p">(</span><span class="n">file</span><span class="p">){</span>
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>  <span class="nf">load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>  <span class="n">sim</span><span class="o">$</span><span class="n">Simulation</span>
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="p">})</span> <span class="o">%&gt;%</span> 
<a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a>  <span class="nf">reduce</span><span class="p">(</span><span class="n">bind_rows</span><span class="p">)</span>
</code></pre></div>
<h3 id="modifying-the-simulation-outputs">Modifying the simulation outputs<a class="headerlink" href="#modifying-the-simulation-outputs" title="Permanent link">&para;</a></h3>
<p>But as we've seen earlier, there are some modifications that we want to apply to the simulation results to make it more interesting for us. One of these modifications is to apply the <code>mergeAlleleAbundance</code> function (changes in the code are highlighted in red for lines that are removed and green for lines that are added):</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="w">sim_df &lt;- lapply(sim_files, function(file){</span>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="w"> </span> load(file)<span class="w"></span>
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="gd">- sim$Simulation</span><span class="w"></span>
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="gi">+ mergeAlleleAbundance(sim$Simulation)</span><span class="w"></span>
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="w">}) %&gt;% </span>
<a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a><span class="w"> </span> reduce(bind_rows)<span class="w"></span>
</code></pre></div>
<p>The second modification is about the <code>trial</code> column. As it is, the script with return one big data-frame with all 500 simulations, but the <code>trial</code> column will be filled with <code>1</code> and <code>2</code> only, so we won't be able to differentiate the simulations. We can correct that by keeping track of the index of the file that we are currently reading. Then we have to make the transformation:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>File index  trial    Simulation index
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>         1      1                   1
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a>                2                   2
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a>         2      1                   3
<a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a>                2                   4
<a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a>         3      1                   5
<a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a>                2                   6
<a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a>         4      1                   7
<a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a>                2                   8
<a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a>etc.
</code></pre></div>
<p>Maybe you noticed that <code>Simulation index = 2*(File index - 1) + trial</code>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="gd">- sim_df &lt;- lapply(sim_files, function(file){</span><span class="w"></span>
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="gi">+ sim_df &lt;- lapply(1:n_sim, function(i){</span><span class="w"></span>
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="gi">+  file &lt;- sim_files[i]</span><span class="w"></span>
<a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="w"> </span> load(file)<span class="w"></span>
<a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a><span class="gd">-  mergeAlleleAbundance(sim$Simulation)</span><span class="w"></span>
<a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a><span class="gi">+  mergeAlleleAbundance(sim$Simulation) %&gt;% </span><span class="w"></span>
<a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a><span class="gi">+    mutate(trial = trial + 2*(i - 1))</span><span class="w"></span>
<a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a><span class="w">}) %&gt;% </span>
<a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a><span class="w"> </span> reduce(bind_rows)<span class="w"></span>
</code></pre></div>
<p>Finally, we'll transform the data-frame into a tibble, just to make our lives easier:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="w">sim_df &lt;- lapply(1:n_sim, function(i){</span>
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="w"> </span> file &lt;- sim_files[i]<span class="w"></span>
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="w"> </span> load(file)<span class="w"></span>
<a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a>
<a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a><span class="w"> </span> mergeAlleleAbundance(sim$Simulation) %&gt;% <span class="w"></span>
<a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a><span class="w"> </span>   mutate(trial = trial + 2*(i - 1))<span class="w"></span>
<a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a><span class="w">}) %&gt;% </span>
<a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a><span class="gd">-  reduce(bind_rows)</span><span class="w"></span>
<a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a><span class="gi">+  reduce(bind_rows) %&gt;% </span><span class="w"></span>
<a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a><span class="gi">+  as_tibble()</span><span class="w"></span>
</code></pre></div>
<p>The final code (which is the one you want to run) is:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="n">sim_df</span> <span class="o">&lt;-</span> <span class="nf">lapply</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="n">n_sim</span><span class="p">,</span> <span class="nf">function</span><span class="p">(</span><span class="n">i</span><span class="p">){</span>
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a>  <span class="n">file</span> <span class="o">&lt;-</span> <span class="n">sim_files</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>  <span class="nf">load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
<a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a>
<a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a>  <span class="nf">mergeAlleleAbundance</span><span class="p">(</span><span class="n">sim</span><span class="o">$</span><span class="n">Simulation</span><span class="p">)</span> <span class="o">%&gt;%</span> 
<a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a>      <span class="nf">mutate</span><span class="p">(</span><span class="n">trial</span> <span class="o">=</span> <span class="n">trial</span> <span class="o">+</span> <span class="m">2</span><span class="o">*</span><span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="m">1</span><span class="p">))</span>
<a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a><span class="p">})</span> <span class="o">%&gt;%</span> 
<a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a>  <span class="nf">reduce</span><span class="p">(</span><span class="n">bind_rows</span><span class="p">)</span> <span class="o">%&gt;%</span> 
<a id="__codelineno-17-9" name="__codelineno-17-9" href="#__codelineno-17-9"></a>  <span class="nf">as_tibble</span><span class="p">()</span>
</code></pre></div>
<h2 id="visualising-the-simulations">Visualising the simulations<a class="headerlink" href="#visualising-the-simulations" title="Permanent link">&para;</a></h2>
<p>Now that we have all 500 simulations into one data-frame, we can easily visualise them! We'll start by using the <code>plotSimulation</code> function from sismonr. We first have to load the <code>sismonr_anthocyanin_system.RData</code> object, which contains the correspondence between species IDs and names, and the colours that we want to use for the plots:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="nf">load</span><span class="p">(</span><span class="s">&quot;~/sism_2021/sismonr_anthocyanin_system.RData&quot;</span><span class="p">)</span>
</code></pre></div>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="nf">plotSimulation</span><span class="p">(</span><span class="n">sim_df</span><span class="p">,</span>
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>               <span class="n">molecules</span> <span class="o">=</span> <span class="nf">names</span><span class="p">(</span><span class="n">colours</span><span class="p">),</span>
<a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a>               <span class="n">mergeComplexes</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span>
<a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a>               <span class="n">labels</span> <span class="o">=</span> <span class="n">id2names</span><span class="p">[</span><span class="nf">names</span><span class="p">(</span><span class="n">colours</span><span class="p">)],</span>
<a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a>               <span class="n">colours</span> <span class="o">=</span> <span class="n">colours</span><span class="p">)</span>
</code></pre></div>
<img alt="A plot of the 500 simulations" src="../images/colsystem_simulations_500trials.png" /></p>
<p>This should look very similar to the first plot we've made of the result of one simulation. This time however, the average abundance of a given species across all simulations is given with a solid line, and the minimum and maximum abundance across the simulations is represented as a shaded area. This plot is really useful to visualise the biological variation that could be observed experimentally for genetically identical plants.</p>
<h2 id="comparing-dfr-expression-between-the-two-plants">Comparing DFR expression between the two plants<a class="headerlink" href="#comparing-dfr-expression-between-the-two-plants" title="Permanent link">&para;</a></h2>
<p>One of the interesting results from these simulations is that we can confirm that the expression of anthocyanin biosynthesis-related genes is reduced in the mutant plant. We can visualise it, by creating a graph (say, a histogram, although a boxplot or density plot would work just as well) of the DFR protein abundance at t = 20 minutes (t = 1,200s) in the two plants. As a reminder, the DFR gene is gene 7 in our sismonr GRN. In the simulation data-frame, the column <code>R7</code> corresponds to the RNAs of gene 7, and the column <code>P7</code> corresponds to the proteins of gene 7.</p>
<p>Have a go at it first! When you are ready, one possible plot is presented below:</p>
<details class="example">
<summary>Example</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="n">sim_df</span> <span class="o">%&gt;%</span> 
<a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a>  <span class="nf">filter</span><span class="p">(</span><span class="n">time</span> <span class="o">==</span> <span class="m">1200</span><span class="p">)</span> <span class="o">%&gt;%</span> <span class="c1">## only keep the last time point of each simulation</span>
<a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a>  <span class="nf">select</span><span class="p">(</span><span class="n">trial</span><span class="p">,</span> <span class="n">Ind</span><span class="p">,</span> <span class="s">&quot;P7&quot;</span><span class="p">)</span> <span class="o">%&gt;%</span> <span class="c1">## we want to focus on DFR proteins abundance </span>
<a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a>  <span class="c1">## for a better plot, show wild-type plant first, and give each individual a nice label </span>
<a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a>  <span class="c1">## (rather than &quot;Ind1&quot; and &quot;Ind2&quot;)</span>
<a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a>  <span class="nf">mutate</span><span class="p">(</span><span class="n">Ind</span> <span class="o">=</span> <span class="nf">factor</span><span class="p">(</span><span class="n">Ind</span><span class="p">,</span> 
<a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a>                      <span class="n">levels</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;Ind1&quot;</span><span class="p">,</span> <span class="s">&quot;Ind2&quot;</span><span class="p">),</span> 
<a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a>                      <span class="n">labels</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;Wild-type&quot;</span><span class="p">,</span> <span class="s">&quot;MYBrep overexpressed&quot;</span><span class="p">)))</span> <span class="o">%&gt;%</span> 
<a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a>  <span class="c1">## Plot section:                    </span>
<a id="__codelineno-20-10" name="__codelineno-20-10" href="#__codelineno-20-10"></a>  <span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">P7</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="n">Ind</span><span class="p">))</span> <span class="o">+</span> 
<a id="__codelineno-20-11" name="__codelineno-20-11" href="#__codelineno-20-11"></a>  <span class="nf">geom_histogram</span><span class="p">(</span><span class="n">alpha</span> <span class="o">=</span> <span class="m">0.5</span><span class="p">,</span> <span class="n">colour</span> <span class="o">=</span> <span class="s">&quot;gray20&quot;</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="m">50</span><span class="p">)</span> <span class="o">+</span> <span class="c1">## alpha = transparency of the bars</span>
<a id="__codelineno-20-12" name="__codelineno-20-12" href="#__codelineno-20-12"></a>  <span class="nf">scale_fill_brewer</span><span class="p">(</span><span class="n">palette</span> <span class="o">=</span> <span class="s">&quot;Set1&quot;</span><span class="p">,</span> <span class="n">direction</span> <span class="o">=</span> <span class="m">-1</span><span class="p">)</span> <span class="o">+</span> <span class="c1">## choose nice colours</span>
<a id="__codelineno-20-13" name="__codelineno-20-13" href="#__codelineno-20-13"></a>  <span class="nf">labs</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s">&quot;DFR protein abundance&quot;</span><span class="p">,</span> <span class="c1">## x axis title</span>
<a id="__codelineno-20-14" name="__codelineno-20-14" href="#__codelineno-20-14"></a>       <span class="n">y</span> <span class="o">=</span> <span class="s">&quot;Count (simulations)&quot;</span><span class="p">,</span> <span class="c1">## y axis title</span>
<a id="__codelineno-20-15" name="__codelineno-20-15" href="#__codelineno-20-15"></a>       <span class="n">fill</span> <span class="o">=</span> <span class="s">&quot;Plant&quot;</span><span class="p">,</span> <span class="c1">## colour legend title</span>
<a id="__codelineno-20-16" name="__codelineno-20-16" href="#__codelineno-20-16"></a>       <span class="n">title</span> <span class="o">=</span> <span class="s">&quot;DFR expression is reduced in mutant plants&quot;</span><span class="p">,</span> <span class="c1">## informative title</span>
<a id="__codelineno-20-17" name="__codelineno-20-17" href="#__codelineno-20-17"></a>       <span class="n">subtitle</span> <span class="o">=</span> <span class="s">&quot;Results from 500 simulations&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="c1">## and subtitle</span>
<a id="__codelineno-20-18" name="__codelineno-20-18" href="#__codelineno-20-18"></a>  <span class="nf">theme_bw</span><span class="p">()</span> <span class="o">+</span> <span class="c1">## white background, black axes, etc</span>
<a id="__codelineno-20-19" name="__codelineno-20-19" href="#__codelineno-20-19"></a>  <span class="nf">theme</span><span class="p">(</span><span class="n">legend.position</span> <span class="o">=</span> <span class="s">&quot;bottom&quot;</span><span class="p">,</span>
<a id="__codelineno-20-20" name="__codelineno-20-20" href="#__codelineno-20-20"></a>        <span class="n">plot.title</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">hjust</span> <span class="o">=</span> <span class="m">0.5</span><span class="p">),</span>    <span class="c1">## center the title</span>
<a id="__codelineno-20-21" name="__codelineno-20-21" href="#__codelineno-20-21"></a>        <span class="n">plot.subtitle</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">hjust</span> <span class="o">=</span> <span class="m">0.5</span><span class="p">),</span> <span class="c1">## and the subtitle</span>
<a id="__codelineno-20-22" name="__codelineno-20-22" href="#__codelineno-20-22"></a>        <span class="n">text</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="m">18</span><span class="p">))</span>            <span class="c1">## and increase font size  </span>
</code></pre></div>
<p><img alt="DFR protein abundance in the two plants" src="../images/colsystem_simulations_fdr_histogram.png" /></p>
</details>
<h2 id="conclusion">Conclusion<a class="headerlink" href="#conclusion" title="Permanent link">&para;</a></h2>
<p>Yay, you've reached the end of this workshop! Feel free to make use of this knowledge in your own research projects :)</p>
<hr />
<p align="center"><b><a href="https://genomicsaotearoa.github.io/Gene_Regulatory_Networks_Simulation_Workshop/">Back to homepage</a></b></p>

              
            </article>
            
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../05_parallel_job_arrays/" class="md-footer__link md-footer__link--prev" aria-label="Previous: 5. Parallel Job Arrays" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              5. Parallel Job Arrays
            </div>
          </div>
        </a>
      
      
        
        <a href="../07_supplementary/" class="md-footer__link md-footer__link--next" aria-label="Next: Supplementary.1" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Supplementary.1
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tracking", "navigation.sections", "navigation.expand", "navigation.top"], "search": "../assets/javascripts/workers/search.b97dbffb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.6c7ad80a.min.js"></script>
      
        <script src="../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>